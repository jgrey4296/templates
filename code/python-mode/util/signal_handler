# -*- mode: snippet -*-
# name  : signal.handler
# uuid  : signal.handler
# key   : signal.handler
# group : util
# --

import signal

class SignalHandler:
    """ Install a breakpoint to run on (by default) SIGINT.

    Can be used as a context manager.
    """
    target : ClassVar[signal.Signals] = signal.SIGINT

    @staticmethod
    def handle(signum, frame):
        breakpoint()
        pass

    @staticmethod
    def install():
        logging.debug("Installing Task Loop handler for: %s",
                      signal.strsignal(SignalHandler.target))
        # Install handler for Interrupt signal
        signal.signal(sig, SignalHandler.handle)

    @staticmethod
    def uninstall():
        logging.debug("Uninstalling Task Loop handler for: %s",
                      signal.strsignal(SignalHandler.target))
        signal.signal(SignalHandler.target, signal.SIG_DFL)

    @staticmethod
    def __enter__() -> Self:
        SignalHandler.install()
        return Self

    @staticmethod
    def __exit__(etype:Maybe[type], err:Maybe[Exception], tb:Maybe[Traceback]) -> bool:
        SignalHandler.uninstall()
        # return False to reraise errors
        return False
